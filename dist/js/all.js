MG={},MG.vent=_.extend({},Backbone.Events),MG.CardModel=Backbone.Model.extend({initialize:function(a){this.set("flipped",!1),this.set("matched",!1),this.set("imagePath",a.imagePath||""),this.set("value",a.value||void 0)},flip:function(){this.get("flipped")||this.set("flipped",!0)}}),MG.GameModel=Backbone.Model.extend({initialize:function(a){this.set("cardsClicked",0),this.set("cardSet",a.cardSet||new MG.CardSetCollection),this.set("inprogress",!1)}}),MG.CardSetCollection=Backbone.Collection.extend({model:MG.CardModel,initialize:function(){},shuffleCards:function(){this.reset(this.shuffle(),{silent:!0})}}),MG.CardView=Backbone.View.extend({className:"card",events:{click:"cardFlipped"},initialize:function(){this.model.on("change:flipped",this.flipCard,this),this.model.on("change:matched",this.removeMatchedCards,this),this.render()},cardFlipped:function(a){a.preventDefault(),this.model.get("flipped")||MG.vent.trigger("cardFlippedEvent",this)},render:function(){var a='<div class="front"></div><div class="back"></div>';$(this.el).append(a),$(this.el).find("div.back").css({"background-image":"url("+this.model.get("imagePath")+")","background-size":"contain","background-repeat":"no-repeat"})},flipCard:function(){this.model.get("flipped")?$(this.el).addClass("flip"):$(this.el).removeClass("flip")},removeMatchedCards:function(){var a=this;setTimeout(function(){$(a.el).find("div.front").addClass("matched"),$(a.el).find("div.back").addClass("matched"),$(a.el).animate({opacity:0}),$(a.el).unbind("click")},300)},destroy:function(){this.remove(),this.unbind()}}),MG.GameBoardView=Backbone.View.extend({className:"board",initialize:function(){this.model.get("cardSet").shuffleCards(),MG.vent.on("cardFlippedEvent",this.checkMatch,this),this.render()},checkMatch:function(a){var b=this;b.model.get("cardsClicked")<2&&(b.model.set("cardsClicked",b.model.get("cardsClicked")+1),a.model.flip()),2==b.model.get("cardsClicked")&&0==b.model.get("inprogress")&&(b.model.set("inprogress",!0),setTimeout(function(){var a=b.model.get("cardSet").where({flipped:!0,matched:!1});a[0].get("value")==a[1].get("value")?setTimeout(function(){a[0].set("matched",!0),a[1].set("matched",!0),b.model.set("cardsClicked",0),b.model.set("inprogress",!1)},400):setTimeout(function(){a[0].set("flipped",!1),a[1].set("flipped",!1),b.model.set("cardsClicked",0),b.model.set("inprogress",!1)},400)},700))},render:function(){var a=$(this.el),b=this.model.get("cardSet");b.each(function(b){var c=new MG.CardView({model:b});a.append(c.el)})},destroy:function(){MG.vent.off("cardFlippedEvent"),this.remove(),this.unbind()}}),$(document).ready(function(){var a=new MG.CardSetCollection([new MG.CardModel({value:"1",matched:!1,imagePath:"images/bargs.jpeg"}),new MG.CardModel({value:"1",matched:!1,imagePath:"images/bargs.jpeg"}),new MG.CardModel({value:"2",matched:!1,imagePath:"images/coorslight.jpeg"}),new MG.CardModel({value:"2",matched:!1,imagePath:"images/coorslight.jpeg"}),new MG.CardModel({value:"3",matched:!1,imagePath:"images/duff.jpeg"}),new MG.CardModel({value:"3",matched:!1,imagePath:"images/duff.jpeg"}),new MG.CardModel({value:"4",matched:!1,imagePath:"images/fattire.jpeg"}),new MG.CardModel({value:"4",matched:!1,imagePath:"images/fattire.jpeg"}),new MG.CardModel({value:"5",matched:!1,imagePath:"images/guinness.jpeg"}),new MG.CardModel({value:"5",matched:!1,imagePath:"images/guinness.jpeg"}),new MG.CardModel({value:"6",matched:!1,imagePath:"images/miller.jpeg"}),new MG.CardModel({value:"6",matched:!1,imagePath:"images/miller.jpeg"}),new MG.CardModel({value:"7",matched:!1,imagePath:"images/oldmilwaukee.jpeg"}),new MG.CardModel({value:"7",matched:!1,imagePath:"images/oldmilwaukee.jpeg"}),new MG.CardModel({value:"8",matched:!1,imagePath:"images/8-bit.jpeg"}),new MG.CardModel({value:"8",matched:!1,imagePath:"images/8-bit.jpeg"})]),b=new MG.GameModel({cardSet:a}),c=new MG.GameBoardView({model:b});$("#appContent").html(c.el)});